<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Finan√ßas F√°cil</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="icon" href="./img/logo.png" type="image/svg+xml">
</head>
<body>
    
    <div class="container">
        <!-- Cabe√ßalho -->
        <header>
            <div class="logo-header">
                <img src="./img/logo.png" alt="Logo" class="logo-small">
                <h2>Ol√°, <span id="userName">...</span>! üëã</h2>
            </div>
            <button id="btnSair" class="btn-danger">Sair</button>
        </header>

        <!-- Dashboard Grid -->
        <main class="dashboard">

            <!-- Card de Saldo -->
            <div class="card" id="saldoCard">
                <h3>Saldo Total</h3>
                <h2 id="saldoTotal">R$ 0,00</h2>
                <div class="saldo-details">
                    <span id="totalEntradas">Entradas: R$ 0,00</span>
                    <span id="totalSaidas">Sa√≠das: R$ 0,00</span>
                </div>
                <!-- NOVO: Adicionado Saldo Pendente -->
                <span id="totalPendente" class="saldo-pendente">Pendente: R$ 0,00</span>
            </div>

            <!-- Card de A√ß√µes -->
            <div class="card" id="actionsCard">
                <h3>A√ß√µes R√°pidas</h3>
                <div class="actions-bar">
                    <button id="btnShowAddTransactionModal">Adicionar Transa√ß√£o</button>
                    <button id="btnPDF" class="btn-secondary">Baixar PDF</button>
                    <button id="btnExcel" class="btn-secondary">Exportar Excel</button>
                </div>
            </div>

            <!-- Card do Gr√°fico -->
            <div class="card" id="chartCard">
                <h3>Entradas vs Sa√≠das (√öltimos 30 dias)</h3>
                <canvas id="financeChart"></canvas>
            </div>

            <!-- Card de Transa√ß√µes -->
            <div class="card" id="transactionsCard">
                <h3>Transa√ß√µes Recentes</h3>
                <!-- ATUALIZADO: Adicionado container para scroll -->
                <div class="table-container">
                    <table id="transactionList">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Tipo</th>
                                <th>Categoria</th>
                                <th>Valor</th>
                                <th>Data</th>
                                <!-- NOVAS COLUNAS -->
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Linhas de transa√ß√£o ser√£o inseridas aqui via JS -->
                        </tbody>
                    </table>
                </div>
                <p id="noTransactionsMessage" style="display: none; text-align: center; margin-top: 20px;">Nenhuma transa√ß√£o encontrada.</p>
            </div>

        </main>
    </div>

    <!-- Modal de Adicionar/Editar Transa√ß√£o -->
    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Adicionar Transa√ß√£o</h3>
                <span class="close-modal" id="closeModal">&times;</span>
            </div>
            <form id="transactionForm">
                <input type="hidden" id="transactionId">
                
                <div class="form-group">
                    <label for="transactionName">Nome (D√≠vida)</label>
                    <input type="text" id="transactionName" placeholder="Ex: Sal√°rio, Aluguel" required>
                </div>
                
                <div class="form-group">
                    <label for="transactionType">Tipo</label>
                    <select id="transactionType" required>
                        <option value="entrada">Entrada</option>
                        <option value="saida">Sa√≠da (D√≠vida)</option>
                    </select>
                </div>

                <!-- NOVO CAMPO: Status (aparece condicionalmente) -->
                <div class="form-group" id="formGroupStatus" style="display: none;">
                    <label for="transactionStatus">Status</label>
                    <select id="transactionStatus" required>
                        <option value="pendente">Pendente</option>
                        <option value="pago">Pago</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="transactionCategory">Categoria</label>
                    <input type="text" id="transactionCategory" placeholder="Ex: Trabalho, Moradia" required>
                </div>

                <div class="form-group">
                    <label for="transactionValue">Valor (R$)</label>
                    <input type="number" id="transactionValue" placeholder="100.00" step="0.01" min="0.01" required>
                </div>

                <div class="form-group">
                    <label for="transactionDate">Data</label>
                    <input type="date" id="transactionDate" required>
                </div>

                <p id="modalErrorMessage"></p>

                <button type="submit" id="btnSaveTransaction">Salvar</button>
            </form>
        </div>
    </div>


    <!-- Scripts de Bibliotecas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

    <!-- Scripts da Aplica√ß√£o (M√≥dulos) -->
    <script type="module" src="./js/firebase.js"></script>
    <script type="module" src="./js/authGuard.js"></script>
    <script type="module" src="./js/home.js"></script>
    <script type="module" src="./js/pdf.js"></script>
    <script type="module" src="./js/excel.js"></script>
</body>
</html>